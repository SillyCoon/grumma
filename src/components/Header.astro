---
import HeaderNav from "./HeaderNav.astro";

import { GET as getReiewCount } from "src/pages/api/sr/review/count";
import Logo from "./Logo.astro";
import { actions } from "astro:actions";

const user = Astro.locals.user;
const reviewCount =
  user && ((await (await getReiewCount(Astro)).json()) as number);
---

<header class="bg-primary p-4 sticky top-0 z-50">
  <div class="container mx-auto flex justify-between items-center">
    <a class="text-3xl font-bold text-white" href="/"><Logo /></a>
    <div class="flex justify-between gap-5">
      <HeaderNav text="Learn" link="/sr/lesson" />
      <HeaderNav
        text="Review"
        link="/sr/review"
        badgeContent={reviewCount ?? ""}
      />
      <HeaderNav text="Grammar" link="/grammar/" />
      <HeaderNav text="Help" link="/help" />
      <!-- <HeaderNav text="Drill" link="/drill/" /> -->
      {
        !user && (
          <a class="text-xl font-bold text-white" href="/auth/signin">
            Login
          </a>
        )
      }
      {
        user && (
          <form method="POST" action={actions.logout}>
            <button type="submit" class="text-lg font-bold text-white">
              Logout
            </button>
          </form>
        )
      }
    </div>
  </div>
</header>
